var subcategories = new Array();
- for subcategory in @subcategories
  subcategories.push(new Array(#{subcategory.category_id}, '#{h subcategory.subcategory_name}', #{subcategory.id}));
function categorySelected() {
category_id = $('purchase_category_id').getValue();
options = $('purchase_subcategory_id').options;
options.length = 1;
subcategories.each(function(subcategory) {
if (subcategory[0] == category_id) {
options[options.length] = new Option(subcategory[1], subcategory[2]);
}
});
if (options.length == 1) {
$('subcategory_field').hide();
} else {
$('subcategory_field').show();
}
}

document.observe('dom:loaded', function() {
categorySelected();
$('purchase_category_id').observe('change', categorySelected);
});
