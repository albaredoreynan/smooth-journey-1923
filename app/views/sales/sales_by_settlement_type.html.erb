<div class="left"> 
<h2><a href="#">SALES BY SETTLEMENT TYPE</a></h2>
<hr/>
<br/>
<% form_tag :sales_by_settlement_type do %>
<table width="500" border="0">
  <tr>
	<td>From:</td>
	<td><%= date_select(:from, '', :start_year => 2000) %></td>
	<td><%= label_tag :restaurant %></td>
	<td><%= collection_select(:restaurant, :restaurant_name, Restaurant.all, :id, :restaurant_name, :prompt => true) %></td>
  </tr>
  <tr>
	<td>To:</td>
	<td><%= date_select(:to, '', :start_year => 2000) %></td>
	<td><%= label_tag :branch %></td>
	<td><%= collection_select(:branch, :branch_location, Branch.all, :id, :branch_location, :prompt => true) %></td>
  </tr>
  <tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
  </tr>
  <tr>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td>&nbsp;</td>
	<td><%= submit_tag :Search %></td>
  </tr>
  <% end %>

</table>
<br/>
</div>

<div class="right">
<strong>Change View: </strong>
<br />
<!--
<select>
  <option>Sales by Category</option>
  <option>Sales by Settlement Type</option>
  <option>Sales by Server:</option>
  <option>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Category</option>
  <option>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Settlement Type</option>
</select>-->
<%= link_to 'Sales by Category Type', sales_path %><br />
<%= link_to 'Sales by Settlement Type', sales_by_settlement_type_path %><br />
<%= link_to 'Sales by Server', sales_by_server_path %>
</div>
<div style="clear:both;"></div>

<hr />
<h2><a href="#">Listing Sales by Settlement Type</a></h2>

<br/>
<% totalst = Hash.new %>
<table border="1" width="1000">
  <tr>
	<th>Date</th>
 	<% @settlement_types.each do |settlementtype|%>
	<th><%= settlementtype.st_name %></th>
	<% totalst = Hash[settlementtype.id => 0]%>
	<% end %>
	<th>VOIDS</th>
	<th>GROSS TOTAL</th>
	<th>NET TOTAL</th>
  </tr>
  
<% totalvat = 0  %>
<% totalgross = 0 %>
<% totalnet = 0   %>

<% @sales.each do |date,sale| %>
	<tr>
	<td><%= date.strftime("%b %d, %Y") %></td>
	<% @settlement_types.each do |settlementtype|%>
	<td><%= number_to_currency(Ssrow.settlement_sales_sum(date,settlementtype.id), :precision => 2, :unit => " ") %></td>
	<% totalst[settlementtype.id] = totalst[settlementtype.id].to_f + Ssrow.settlement_sales_sum(date,settlementtype.id) %>
  	<% end %>
  	<td><%= number_to_currency(sale.map(&:void).sum, :precision => 2, :unit => " ") %></td>
  	<% totalvat = totalvat + sale.map(&:void).sum %>
  	<td><%= number_to_currency(sale.map(&:gross_total_ss).sum, :precision => 2, :unit => " ") %></td>
  	<% totalgross = totalgross + sale.map(&:gross_total_ss).sum %>
  	<td><%= number_to_currency(sale.map(&:net_total_ss).sum, :precision => 2, :unit => " ") %></td>
  	<% totalnet = totalnet + sale.map(&:net_total_ss).sum %>
  </tr>
<% end %>
  <tr>
	<td><center><b>TOTAL</b></center></td>
	<% @settlement_types.each do |settlementtype| %>
	<td><%= number_to_currency(totalst[settlementtype.id], :precision => 2, :unit => " ") %></td>
  	<% end %>
  	<td><%= number_to_currency(totalvat, :precision => 2, :unit => " ") %></td>
  	<td><%= number_to_currency(totalgross, :precision => 2, :unit => " ") %></td>
  	<td><%= number_to_currency(totalnet, :precision => 2, :unit => " ") %></td>
  </tr>
</table>
<br />

<%= link_to 'New Sale', new_sale_path %>
