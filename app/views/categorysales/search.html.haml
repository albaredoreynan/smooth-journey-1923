.left
  %h2
    %a{:href => "#"} SEARCH CATEGORY SALES
  %hr/
  %br/
  - form_tag '/categorysales/search' do
    %table{:border => "0", :width => "500"}
      %tr
        %td From:
        %td= date_select(:start, '', :start_year => 2010)
        %td Restaurant:
        %td= text_field_tag :restaurant
      %tr
        %td To:
        %td= date_select(:end, '', :start_year => 2010)
        %td= label_tag :branch
        %td= text_field_tag :branch
      %tr
        %td &nbsp;
        %td &nbsp;
        %td= submit_tag "Search"
  %br/
  %br/
.right
  %strong Change View:
  %br/
  /
    <select>
    <option>Sales by Category</option>
    <option>Sales by Settlement Type</option>
    <option>Sales by Server:</option>
    <option>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Category</option>
    <option>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Settlement Type</option>
    </select>
  = link_to 'Sales by Category Type', categorysales_path
  %br/
  = link_to 'Sales by Settlement Type', settlement_sales_path
  %br/
  = link_to 'Server Sales by Settlement Type', serversales_path
%div{:style => "clear:both;"}
%hr/
%h2
  %a{:href => "#"}
    SEARCH: #{p "#{@searchdate} - #{@enddate}"}
%br/
%table{:border => "1", :width => "1000"}
  %tr
    %th Date
    %th Food
    %th Liquor
    %th Beverage
    %th Vat
    %th Void
    %th Service Charge
    %th Total Revenue
    %th Customer Count
    %th Transaction Count
    %th Edit
  - @categorysales.each do |date,categorysale|
    %tr
      %td= p "#{date}"
      - food = 0
      - liquor = 0
      - beverage = 0
      - hash = {}
      - amounts = categorysale.map(&:cs_amount)
      - category_ids = categorysale.map(&:category_id)
      - category_ids.size.times { |i| hash[category_ids[i]] = amounts[i]}
      - hash.each_pair do |ci,amt|
        - if ci==0
          - food = amt
        - elsif ci==1
          - liquor = amt
        - elsif ci==2
          - beverage = amt
      %td= p "#{food}"
      %td= p "#{liquor}"
      %td= p "#{beverage}"
      %td= p "#{categorysale.map(&:vat).first}"
      %td= p "#{categorysale.map(&:void).first}"
      %td= p "#{categorysale.map(&:servicecharge).first}"
      %td= p "#{categorysale.map(&:cs_revenue).first}"
      %td= p "#{categorysale.map(&:customer_count).first}"
      %td= p "#{categorysale.map(&:transaction_count).first}"
      %td= link_to "Edit"
%br/
= link_to 'New Category Sale', new_categorysale_path
